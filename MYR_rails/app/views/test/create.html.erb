<!DOCTYPE html>
<html>
<head>
	<style type="text/css">
	html, body, #map-canvas { height: 100%; margin: 0; padding: 0;}
	</style>
	<script type="text/javascript"
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCo59o2hZMz28Crm8UeHRp3lRN56OOii7o">
	</script>
	<script type="text/javascript">
	//---------------------GLOBAL VARIABLES-----------------------------
	var map = null;
	var lastDatetime = 0;
	//------------------------------------------------------------------

	//----------------------GOOGLE MAP WORLD---------------------------
	//MAP INITIALIZATION
	function initialize() {
		//MAP OPTIONS
		var mapOptions = {
			center: { lat: -34.397, lng: 150.644},
			zoom: 8
		};
		//MAP CREATION
		map = new google.maps.Map(document.getElementById('map-canvas'),
			mapOptions);
	}

	google.maps.event.addDomListener(window, 'load', initialize);
	//-----------------------------------------------------------------

	//----------------------FUNCTIONS---------------------------

	//Set the center of the map
	function setCenter(lat, lng){
		map.setCenter(new google.maps.LatLng(lat,lng));
	}

	//Add a marker to the map
	function addMarker(lat, lng){
		var marker = new google.maps.Marker(
		{
			position: new google.maps.LatLng(lat,lng)
		}
		);
		marker.setMap(map);
	}

	//Save the last datetime
	function saveLastDatetime(datetime){
		lastDatetime = datetime;
	}



	</script>
</head>
<body>
	<button id="doit" type="button">Add Marker</button> 
	<button id="sendparam" type="button">Send Parameter</button> 
	<div id="map-canvas"></div>
</body>

<script>
//---------------------JQUERY WORLD---------------------------
$("#doit").click(function()
{
	$.ajax({
		type: "GET",
		url: "/coordinates.json",
		dataType: "json",
		success: function(data){
			for(i=0; i < data.length ; i++){
				lat = data[i].latitude;
				lng = data[i].longitude;
				addMarker(lat,lng);
			}
			//check if do not bug with parameters
			saveLastDatetime(data[data.length-1].datetime);
			setCenter(lat,lng);
		}        
	});
}
)

$("#sendparam").click(function()
{
	alert("lets try");
	$.ajax({
		type: "GET",
		url: "/data?datetime=20160101",
		dataType: "json",
		success: function(data){
			alert(data);
			alert("jai affiché un truc là non ?");
		}       
	});
}
)
//-----------------------------------------------------------------
</script>
</html>